<div ng-controller="programs-books">

	<div class="info-panel">
		<div class="form-group">
			<label class="form-label">
				<i class="bi bi-mortarboard-fill"></i>
				البرنامج
			</label>
			<select id="program" ng-model="program.id" class="form-select" placeholder="البرنامج" ng-options="program.id as program.name for program in programs" ng-disabled="programs.length == 1 || submitted" ng-change="updateProgram()">
				<option disabled="disabled" ng-value="0">اختر البرنامج</option>
			</select>
		</div>
		<div class="help-text-enhanced">
			<small>
				<i class="bi bi-info-circle"></i>
				اختر البرنامج لإدارة المدفوعات
			</small>
		</div>
	</div>
	
	<div class="card">
		<div class="card-header">
			<div>
				<i class="bi bi-people"></i>
				قائمة الطلبة
			</div>
		</div>
		
		<div id="students" class="accordion">
			
			<div class="card-body">
			
				<div class="payment-item" ng-repeat="student in students | orderBy : 'name' track by $index">
					
					<div id="student{{$index}}head" class="payment-item-header">
						<button class="payment-toggle-btn w-100" type="button" data-bs-toggle="collapse" data-bs-target="#student{{$index}}" aria-expanded="false" aria-controls="student{{$index}}">
							<div class="d-flex justify-content-between align-items-center">
								<div class="student-info">
									<div class="counter-badge">{{$index + 1}}</div>
									<i class="bi bi-person-fill"></i>
									{{student.name}}
								</div>
								<div class="payment-status">
									<div class="status-badge status-badge-active" ng-show="books[student.cpr] != null && books[student.cpr].selected">
										<i class="bi bi-check-circle-fill"></i>
										مستلم
									</div>
									<div class="status-badge status-badge-inactive" ng-hide="books[student.cpr] != null && books[student.cpr].selected">
										<i class="bi bi-x-circle-fill"></i>
										غير مستلم
									</div>
								</div>
							</div>
						</button>
					</div>
					
					<div id="student{{$index}}" class="collapse" aria-labelledby="student{{$index}}head" data-bs-parent="#students">
						
						<div class="payment-item-content">
							
							<div class="payment-toggle-section">
								<div class="input-group payment-input-group">
									<div class="input-group-text">
										<div class="form-check form-switch">
											<input id="course{{student.cpr}}" ng-model="books[student.cpr].selected" type="checkbox" class="form-check-input form-check-input-lg" ng-value="true" ng-true-value="true" ng-false-value="false" ng-disabled="submitted" ng-change="updateStudentBook(student)">
										</div>
									</div>
									<label for="course{{student.cpr}}" class="form-control">
										كتاب البرنامج
										<i class="bi bi-book-fill"></i>
									</label>
									<div class="status-badge status-badge-active" ng-show="books[student.cpr] != null && books[student.cpr].selected">
										<i class="bi bi-check-circle-fill"></i>
										مستلم
									</div>
									<div class="status-badge status-badge-inactive" ng-hide="books[student.cpr] != null && books[student.cpr].selected">
										<i class="bi bi-x-circle-fill"></i>
										غير مستلم
									</div>
								</div>
							</div>
							
							<div class="payment-info-section mt-3" ng-show="books[student.cpr] != null">
								<div class="row">
									<div class="col-md-6">
										<div class="info-panel info-panel-success">
											<i class="bi bi-cash"></i>
											<strong>تاريخ التسليم:</strong> {{books[student.cpr].time}}
										</div>
									</div>
									<div class="col-md-6">
										<div class="info-panel">
											<i class="bi bi-person-check"></i>
											<strong>الحالة:</strong> مستلم
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
	</div>
	
</div>