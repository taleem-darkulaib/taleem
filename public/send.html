<!DOCTYPE html>
<html dir="rtl" lang="ar">
	<head>
		<title>ارسال رسائل الواتسب</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width = device-width, initial-scale = 1, user-scalable = no">
		<link rel="shortcut icon" href="https://store-images.s-microsoft.com/image/apps.8453.13655054093851568.4a371b72-2ce8-4bdb-9d83-be49894d3fa0.7f3687b9-847d-4f86-bb5c-c73259e2b38e">

		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
		<link rel="stylesheet" type="text/css" href="styles/style.css?version=25" />
		
		<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-route.min.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.4.0/exceljs.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.10.3/typeahead.jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/checklist-model/1.0.0/checklist-model.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-sanitize/1.8.3/angular-sanitize.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/flatpickr/4.6.13/flatpickr.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
		
		<script src="scripts/firebase.js?version=20251208"></script>
		<script src="scripts/common.js?version=20251208"></script>
		<script src="scripts/send.js?version=25"></script>
		
	</head>
	<tbody class="bg-light">
		<div class="container mt-4" ng-app="application" ng-controller="controller">
			
			<div class="card card-body">

				<h3 class="form-title arabic-text">
					ارسال رسائل الواتسب
				</h3>

				<div class="alert alert-custom d-flex align-items-center" ng-class="alert.class">
					<i class="bi alert-icon" ng-class="alert.icon"></i>
					<div>
						<strong class="ms-2">{{alert.title}}</strong> {{alert.message}}
					</div>
				</div>
				
				<div class="card">
					<div class="card-header text-bg-primary">
						<i class="bi bi-whatsapp ms-1"></i>
						ارسال رسائل الواتسب
					</div>
					<div class="card-body">
						
						<div class="mb-3">
							<label for="mobiles" class="form-label">
								<i class="bi bi-phone ms-1"></i>
								أرقام الهاتف
							</label>
							<textarea id="mobiles" ng-model="send.mobiles" type="text" class="form-control" rows="5" placeholder="أرقام الهاتف" ng-disabled="submitted"></textarea>
						</div>
						
						<div class="mb-3">
							<label for="content" class="form-label">
								<i class="bi bi-chat ms-1"></i>
								الرسالة
							</label>
							<textarea id="content" ng-model="send.content" class="form-control" rows="5" placeholder="الرسالة" ng-disabled="submitted"></textarea>
						</div>
						
					</div>
					<div class="card-footer text-center" ng-hide="submitted">
						<button class="btn btn-primary" ng-click="sendWhatsApp()" ng-disabled="send.mobiles == null || send.content.trim().length == 0 || send.content == null || send.content.trim().length == 0">
							<i class="bi bi-send ms-1"></i>
							ارسال
						</button>
					</div>
				</div>
				
				<div class="card">
					<div class="card-header text-bg-primary">
						<i class="bi bi-whatsapp ms-1"></i>
						الرسائل
					</div>
					<div class="table-responsive mt-3">
						<table class="table table-striped">
							<thead>
								<tr>
									<th>
										<i class="bi bi-hash"></i>
									</th>
									<th>
										<i class="bi bi-list ms-1"></i>
										النوع
									</th>
									<th>
										<i class="bi bi-telephone ms-1"></i>
										رقم الهاتف
									</th>
									<th>
										<i class="bi bi-chat-dots ms-1"></i>
										الرسالة
									</th>
									<th>
										<i class="bi bi-clock-history ms-1"></i>
										وقت طلب الارسال
									</th>
									<th>
										<i class="bi bi-send ms-1"></i>
										وقت الارسال
									</th>
									<th>
										<i class="bi bi-info-circle ms-1"></i>
										الحالة
									</th>
									<th>
										<i class="bi bi-trash ms-1"></i>
										حذف
									</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="message in messages track by $index" ng-hide="messages == null">
									<td>
										{{$index + 1}}
									</td>
									<td>
										{{message.type}}
									</td>
									<td>
										{{message.mobile}}
									</td>
									<td>
										{{message.content}}
									</td>
									<td>
										{{message.time}}
									</td>
									<td>
										{{message.sendTime}}
									</td>
									<td>
										<span class="badge text-bg-success p-2" ng-show="message.send">
											<i class="bi bi-check-circle ms-1"></i>
											تم الارسال
										</span>
										<span class="badge text-bg-warning p-2" ng-hide="message.send">
											<i class="bi bi-hourglass ms-1"></i>
											قيد الارسال
										</span>
									</td>
									<td>
										<button class="btn btn-danger" ng-click="deleteMessage(message)">
											<i class="bi bi-trash m-0"></i>
										</button>
									</td>
								</tr>
								<tr ng-show="messages == null">
									<td class="text-center" colspan="6">
										<div class="spinner-border text-primary" role="status">
											<span class="sr-only"></span>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="card-footer text-center" ng-hide="submitted">
						<button class="btn btn-primary" ng-click="deleteSent()">
							<i class="bi bi-trash ms-1"></i>
							حذف المرسل
						</button>
					</div>
				</div>
				
			</div>
		</div>
	</body>
</html>